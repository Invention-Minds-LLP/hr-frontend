<div class="question-bank">
  <!-- If editing/creating, show the editor -->
  <ng-container *ngIf="showEditor; else listView">
    <app-question-bank-editor
      [bankId]="editingBank?.id"
      [bankPreset]="editingBank"
      (saved)="onBankSaved()"
      (closed)="closeForm()">
    </app-question-bank-editor>
  </ng-container>

  <!-- Else show the table -->
  <ng-template #listView>
    <div class="header">
      <h2>Question Bank List</h2>
      <button (click)="openForm()" class="add-btn">
        Add New QB
        <svg xmlns="http://www.w3.org/2000/svg" width="21" height="20" viewBox="0 0 21 20" fill="none">
          <path d="M10.5003 4.16663V15.8333M4.66699 9.99996H16.3337" stroke="white" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </button>
    </div>

    <p-table [value]="questionBanks" [paginator]="true" [rows]="10">
      <ng-template pTemplate="header">
        <tr>
          <th>No</th>
          <th>Name</th>
          <th>Role</th>
          <th>Department ID</th>
          <th>Difficulty</th>
          <th style="text-align: center;">Action</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-bank let-i="rowIndex">
        <tr>
          <td>{{ i + 1 }}</td>
          <td>{{ bank.name }}</td>
          <td>{{ bank.role }}</td>
          <td class="t-data al">
            <span class="dept-badge" [ngStyle]="{ backgroundColor: getDepartmentColors(bank.departmentId).badgeColor }">
              <span class="dot" [ngStyle]="{ backgroundColor: getDepartmentColors(bank.departmentId).dotColor }"></span>
              {{ getDepartmentName(bank.departmentId) }}
            </span>
          </td>
          <td>{{ bank.difficulty }}</td>
          <td class="button-div">
            <button class="btn-edit" (click)="openForm(bank)">Edit QB</button>
            <!-- <button class="btn-edit" (click)="selectQuestionBank(bank)">Questions</button> -->
          </td>
        </tr>
      </ng-template>
    </p-table>
  </ng-template>
</div>
