<div *ngIf="!selectedInterview" class="interview-table">
  <div class="header">
    <!-- <h2>Exit Interviews</h2> -->
    <div class="flex1">
      <div class="filter" (click)="toggleFilterDropdoen()">
        <i class="pi pi-filter"></i>
        <ul class="menu-list" *ngIf="showFilterDropdown">
          <li class="list" *ngFor="let option of filterOptions" (click)="selectFilter(option); $event.stopPropagation()"
            [ngClass]="{ 'active': selectedFilter?.value === option.value }">
            {{ option.label }}
          </li>
        </ul>
      </div>

      <p-iconfield>
        <p-inputicon class="pi pi-search" />
        <input type="text" pInputText placeholder="Search" (input)="onSearch($event)" />
      </p-iconfield>
    </div>
  </div>
  <p-table [value]="filteredInterviews" [paginator]="true" [rows]="10" [loading]="loading">
    <ng-template pTemplate="header">
      <tr>
        <th>No</th>
        <th>EMP ID</th>
        <th>Name</th>
        <th>Department</th>
        <th>Date</th>
        <th>Interviewer</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-interview let-i="rowIndex">
      <tr>
        <td>{{ i + 1 }}</td>
        <td>{{ interview.employee?.employeeCode }}</td>
        <td>{{ interview.employee?.firstName }} {{ interview.employee?.lastName }}</td>
        <td>
          <span class="dept-badge"
            [ngStyle]="{ backgroundColor: getDepartmentColors(interview.employee?.departmentId).badgeColor }">
            <span class="dot"
              [ngStyle]="{ backgroundColor: getDepartmentColors(interview.employee?.departmentId).dotColor }">
            </span>
            {{ departmentMap[interview.employee?.departmentId] }}
          </span>
        </td>
        <td>{{ interview.scheduledAt | date:'dd-MM-yyyy' }}</td>
        <td>{{ interview.interviewerName }}</td>
        <td>
          <p-badge
            [value]="interview.completedAt ? 'COMPLETED' : (interview.status || 'PENDING')"
            [severity]="
              interview.completedAt ? 'success' :
              interview.status === 'SCHEDULED' ? 'info' :
              interview.status === 'CANCELLED' ? 'danger' :
              'warn'
            ">
          </p-badge>
        </td>
        
          <td>
          <button pButton label="View / Edit" (click)="openInterview(interview)"></button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<div *ngIf="selectedInterview">
  <app-exit-interview [formData]="selectedInterview" (closeForm)="closeForm()"></app-exit-interview>
</div>